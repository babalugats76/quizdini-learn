(function(e){function t(t){for(var i,o,s=t[0],c=t[1],d=t[2],u=0,h=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);l&&l(t);while(h.length)h.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},r={app:0},a=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"015f":function(e,t,n){},"10a7":function(e,t,n){},"17c0":function(e,t,n){},"1c66":function(e,t,n){"use strict";n("3f69")},2089:function(e,t,n){"use strict";n("70f3")},"253b":function(e,t,n){},3886:function(e,t,n){"use strict";n("253b")},"3f69":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("a79d");var i=n("7a23");function r(e,t,n,r,a,o){const s=Object(i["C"])("router-view");return Object(i["u"])(),Object(i["f"])(s)}var a={name:"App"};n("9cdc");a.render=r;var o=a,s=n("6c02");const c=Object(i["M"])("data-v-c54af548"),d=c((function(e,t,n,r,a,o){const s=Object(i["C"])("Game");return Object(i["u"])(),Object(i["f"])(s)}));var l=n("bc3a"),u=n.n(l);u.a.defaults.headers.common["quizdini-timezone"]=Intl.DateTimeFormat().resolvedOptions().timeZone;const h={timeout:3e4},m=async({url:e,config:t=h})=>{console.log("url",e),console.log("config",t);try{const n=await u.a.get(e,t);return{data:n.data}}catch(n){return{error:n.response.data}}},g="/api/match",f=e=>m({url:`${g}/${e}`});var p={board:{debug:!0,timeouts:{throttle:33}},game:{timeouts:{enter:1e3,leave:1e3}},tile:{timeouts:{enter:800,hit:800,leave:0,miss:800,shuffle:500}},timer:{debug:!0,thresholds:{warn:40,alert:20},timeouts:{interval:100,change:250,enter:1e3,leave:1e3}}};const v=Object(i["y"])({canDnD:!1,colorScheme:null,correct:0,definitions:[],duration:60,gameId:null,incorrect:0,itemsPerBoard:9,matches:[],playing:!1,score:0,showBoard:!1,stats:[],terms:[],title:null}),b=p,O={canDnD:()=>v.canDnD,colorScheme:()=>v.colorScheme,correct:()=>v.correct,definitions:()=>v.definitions,duration:()=>v.duration,gameId:()=>v.gameId,incorrect:()=>v.incorrect,itemsPerBoard:()=>v.itemsPerBoard,matches:()=>v.matches,playing:()=>v.playing,score:()=>v.score,showBoard:()=>v.showBoard,stats:()=>v.stats,terms:()=>v.terms,title:()=>v.title},j={setCanDnD:e=>v.canDnD=e,setColorScheme:e=>v.colorScheme=e,setCorrect:e=>v.correct=e,setDefinitions:e=>v.definitions=e,setDuration:e=>v.duration=e,setGameId:e=>v.gameId=e,setIncorrect:e=>v.incorrect=e,setItemsPerBoard:e=>v.itemsPerBoard=e,setMatches:e=>v.matches=e,setPlaying:e=>v.playing=e,setScore:e=>v.score=e,setShowBoard:e=>v.showBoard=e,setStats:e=>v.stats=e,setTerms:e=>v.terms=e,setTitle:e=>v.title=e};n("ddb0");var y=n("8dee"),M=n.n(y);function w(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function I(e,t,n="id"){return Object.prototype.hasOwnProperty.call(t,n)?e.map(e=>e[n]!==t[n]?e:{...e,...t}):e}function D(e,t,n="id",i){if(!Object.prototype.hasOwnProperty.call(t,n))return e;const r=e.find(e=>e[n]===t[n]),a=i?i(r):t;return r?e.map(e=>e[n]!==a[n]?e:{...e,...a}):e.concat(a)}function T(e,t,n){return{transform:"translate3d("+e+"px, "+t+"px, "+n+"px)"}}function _(e,t,n,i,r,a,o){return{"--hit-start-tx":e+"px","--hit-start-ty":t+"px","--hit-start-tz":n+"px","--hit-end-tx":i+"px","--hit-end-ty":r+"px","--hit-end-tz":a+"px","--hit-duration":o+"ms"}}function x(e,t,n){return{...T(e,t,n)}}function S(e){console.log("loading data...");const{matchId:t,matches:n=[],options:{duration:i=60,colorScheme:r="",itemsPerBoard:a=9}={},title:o=""}=e;v.colorScheme=r,v.duration=i,v.gameId=t,v.itemsPerBoard=a,v.matches=n,v.title=o}function P(){console.log("dealing...");const e=w(v.matches),t=e.slice(0,Math.min(v.itemsPerBoard,e.length));let n=t.map(e=>({...e,matched:!1,show:!0})),i=w(n.map(e=>{const{term:t,definition:n,...i}=e;return{...i,content:t,answer:n,id:M.a.generate()}})),r=[...n];r=r.map(e=>{const{term:t,definition:n,...i}=e;return{...i,content:n,id:M.a.generate()}}),v.terms=i,v.definitions=r}function B(){console.log("shuffling..."),v.terms=w(v.terms),v.definitions=w(v.definitions)}function L(e,t){const{answer:n}=v.terms.find(t=>t.id===e)||{},{content:i}=v.definitions.find(e=>e.id===t)||{};return!!n&&!!i&&n===i}function C(e){const{dragId:t,dragX:n,dragY:i}=e||{};v.terms=I(v.terms,{id:t,style:v.moveStyle(n,i,1),className:"drag"})}function E(e){const{dropId:t}=e||{};v.definitions=v.definitions.map(e=>({...e,className:e.id!==t||e.matched?"":"over"}))}function X(e){const{dragId:t,dragX:n,dragY:i,dropId:r,dropX:a,dropY:o}=e||{},s=!!r&&L(t,r);if(v.terms=I(v.terms,{id:t,matched:s,className:s?"hit":"miss",style:s?_(n,i,1,a,o,1,b.tile.hitMs):x(0,0,0)}),!r)return;v.definitions=I(v.definitions,{id:r,className:s?"hit":"",...s&&{matched:!0}});const{content:c}=v.terms.find(e=>e.id===t)||{};v.score=Math.max(s?v.score+1:v.score-1,0),v.stats=D(v.stats,{term:c},"term",e=>e?{term:c,hit:s?e.hit+1:e.hit,miss:s?e.miss:e.miss+1}:{term:c,hit:s?1:0,miss:s?0:1})}function Y(){console.log("game over..."),v.playing=!1,v.showBoard=!1}const $={deal:P,gameOver:Y,isMatch:L,load:S,onDrag:C,onDrop:X,onOver:E,shuffle:B},A=Object(i["M"])("data-v-8aa15f8c");Object(i["x"])("data-v-8aa15f8c");const N={class:"match-game"};Object(i["v"])();const G=A((function(e,t,n,r,a,o){const s=Object(i["C"])("Board"),c=Object(i["C"])("Timer");return Object(i["u"])(),Object(i["f"])("div",N,[Object(i["i"])(s,{active:e.playing,config:r.config.board,onDrag:e.onDrag,onOver:e.onOver,onDrop:e.onDrop},null,8,["active","config","onDrag","onOver","onDrop"]),Object(i["i"])(c,{active:e.playing,config:r.config.timer,duration:e.duration,score:e.score,onTimerExpired:e.gameOver},null,8,["active","config","duration","score","onTimerExpired"])])})),k=Object(i["M"])("data-v-3f8de7c3");Object(i["x"])("data-v-3f8de7c3");const q={class:"dnd-board",ref:"dndRef"};Object(i["v"])();const z=k((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])("div",q,[Object(i["B"])(e.$slots,"default")],512)}));var F=n("2ef0"),H=n.n(F);function R({active:e,element:t,throttleMs:n=0,debug:r=!1,emit:a}){const o=Object(i["y"])({dragged:{},listeners:[],throttledDrag:Object(i["d"])(()=>H.a.throttle(m,n,{trailing:!0}))}),s={mousedown:h,mousemove:o.throttledDrag,mouseup:g,touchstart:h,touchmove:o.throttledDrag,touchend:g};function c(e){e.forEach(n=>{r&&console.log(`adding ${n}...`),t.value.addEventListener(n,s[n]),o.listeners=o.listeners.concat(e).filter((e,t,n)=>n.indexOf(e)===t)})}function d(e){e.forEach(n=>{r&&console.log(`removing ${n}...`),t.value.removeEventListener(n,s[n]),o.listeners=o.listeners.filter(t=>e.indexOf(t)<0)})}function l(){c(["mousedown","touchstart"])}function u(){o.dragged={},d(o.listeners)}function h(e){e.stopPropagation(),r&&console.log((o.dragged.id?`${e.type} (${o.dragged.id}) `:""+e.type)+"...");const t=e.target.classList.contains("draggable")?e.target:e.target.closest(".draggable");if(!t)return;const n="touchstart"===e.type?e.touches[0].clientX:e.clientX,i="touchstart"===e.type?e.touches[0].clientY:e.clientY,{top:a,left:s}=t.getBoundingClientRect();o.dragged={id:t.id,offsetX:n-s,offsetY:i-a,initialX:n,initialY:i};const d="touchstart"===e.type?["touchmove","touchend"]:["mousemove","mouseup"];c(d)}function m(e){e.stopPropagation(),r&&console.log((e.target.id?`${e.type} (${e.target.id}) `:""+e.type)+"...");const{id:t,initialX:n,initialY:i,overId:s}=o.dragged,c="touchmove"===e.type?e.touches[0].clientX-n:e.clientX-n,d="touchmove"===e.type?e.touches[0].clientY-i:e.clientY-i;a("drag",{dragId:t,dragX:c,dragY:d});const{id:l=""}=document.elementsFromPoint("touchmove"===e.type?e.touches[0].clientX:e.clientX,"touchmove"===e.type?e.touches[0].clientY:e.clientY).find(e=>e.classList.contains("droppable"))||{};s!==l&&(r&&console.log(`${t} is over ${l}...`),a("over",{overId:l}),o.dragged={...o.dragged,overId:l})}function g(e){e.stopPropagation(),o.throttledDrag.cancel();const{id:t,initialX:n,initialY:i,offsetX:s,offsetY:c}=o.dragged;r&&console.log((t?`${e.type} (${t}) `:""+e.type)+"...");const l="touchend"===e.type?e.changedTouches[0].clientX:e.clientX,u="touchend"===e.type?e.changedTouches[0].clientY:e.clientY,h=document.elementsFromPoint(l,u).find(e=>e.classList.contains("droppable")),{top:m,left:g}=h&&h.getBoundingClientRect()||{};a("drop",{dragId:t,dragX:h?l-n:l,dragY:h?u-i:u,dropId:h?h.id:null,dropX:h?Math.round(g-n+s):null,dropY:h?Math.round(m-i+c):null}),o.dragged={};const f="touchstart"===e.type?["touchmove","touchend"]:["mousemove","mouseup"];d(f)}return Object(i["s"])(()=>{r&&console.log(`dnd mounted (${e.value?"active":"inactive"})...`),e.value&&c(["mousedown","touchstart"])}),Object(i["K"])(e,(e,t)=>(r&&console.log("active changed: ",t,"=>",e),e&&!t?l():u())),{...Object(i["H"])(o)}}var J={name:"Board",props:["active","config"],setup(e,{emit:t}){const n=Object(i["z"])(null),{active:r}=Object(i["H"])(e);return{...e.config,...R({active:r,element:n,...e.config,emit:t}),dndRef:n}}};n("64b6");J.render=z,J.__scopeId="data-v-3f8de7c3";var U=J;const W=Object(i["M"])("data-v-7a9d9598"),K=W((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])("div",{id:n.id,innerHTML:n.content},null,8,["id","innerHTML"])}));var Z={name:"Draggable",props:["content","id"]};n("93e9");Z.render=K,Z.__scopeId="data-v-7a9d9598";const Q=Object(i["M"])("data-v-65bdf1c2"),V=Q((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])("div",{id:n.id,innerHTML:n.content},null,8,["id","innerHTML"])}));var ee={name:"Droppable",props:["content","disabled","id"]};n("91f5");ee.render=V,ee.__scopeId="data-v-65bdf1c2";const te=Object(i["M"])("data-v-275f8882");Object(i["x"])("data-v-275f8882");const ne={class:"match-timer"},ie={class:"timer"},re={class:"timer__wrapper"},ae={class:"timer__svg",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"},oe={class:"timer__circle"};Object(i["v"])();const se=te((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])(i["b"],{duration:{enter:""+e.timeouts.enter,leave:""+e.timeouts.leave},name:"timer",onBeforeEnter:o.beforeEnter,onAfterEnter:o.afterEnter,onAfterLeave:o.afterLeave},{default:te(()=>[Object(i["L"])(Object(i["i"])("div",ne,[Object(i["i"])("div",ie,[Object(i["i"])(i["b"],{appear:"",duration:{enter:""+e.timeouts.change,leave:""+e.timeouts.change},name:"scoring",onAfterLeave:e.endScoreChange},{default:te(()=>[Object(i["L"])(Object(i["i"])("div",re,[(Object(i["u"])(),Object(i["f"])("svg",ae,[Object(i["i"])("g",oe,[Object(i["i"])("circle",{class:["timer__path-elapsed",o.scoreClass],cx:"50",cy:"50",r:"45"},null,2),Object(i["i"])("path",{"stroke-dasharray":o.strokeDasharray,class:["timer__path-remaining",[e.severity,o.scoreClass]],d:"M 50, 50\n            m -45, 0\n            a 45,45 0 1,0 90,0\n            a 45,45 0 1,0 -90,0\n          "},null,10,["stroke-dasharray"])])])),Object(i["i"])("span",{class:["timer__label",o.scoreClass]},Object(i["F"])(n.score||e.formatted),3)],512),[[i["J"],!e.scoring]])]),_:1},8,["duration","onAfterLeave"])])],512),[[i["J"],n.active]])]),_:1},8,["duration","onBeforeEnter","onAfterEnter","onAfterLeave"])})),ce={ALERT:"alert",WARN:"warn",SUCCESS:"success"},de={UP:"up",DOWN:"down"};function le({duration:e,score:t,interval:n,warn:r,alert:a,debug:o=!1,emit:s}){const c=Object(i["y"])({elapsed:0,expired:Object(i["d"])(()=>c.remaining<=0),formatted:Object(i["d"])(()=>{const e=Math.floor(c.remaining/6e4),t=Math.floor(c.remaining%6e4/1e3);return t<10?`${e}:0${t}`:`${e}:${t}`}),intervalId:null,progress:Object(i["d"])(()=>Math.round(c.remaining/(1e3*e.value)*1e4)/100),remaining:Object(i["d"])(()=>1e3*e.value-c.elapsed),scoring:!1,scoringStatus:"",SCORING_STATUS:de,severity:Object(i["d"])(()=>c.progress<=r?c.progress<=a?ce.ALERT:ce.WARN:ce.SUCCESS)});function d(){o&&console.log("timer start..."),c.elapsed=0,c.intervalId=setInterval(()=>{c.elapsed+=n},n)}function l(e){c.elapsed=e}function u(){o&&console.log("timer scoring end..."),c.scoring=!1,c.scoringStatus=""}function h(){o&&console.log("timer end..."),c.intervalId&&(clearInterval(c.intervalId),c.intervalId=null)}return Object(i["K"])(t,(e,t)=>{o&&console.log("score changed: ",t,"=>",e),c.scoring=!0,c.scoringStatus=e>t?de.UP:de.DOWN}),Object(i["K"])(()=>c.expired,(e,t)=>{e&&!t&&(o&&console.log("timer expired: ",t,"=>",e),h(),s("timer-expired"))}),Object(i["q"])(()=>{o&&console.log("timer cleaning up..."),h()}),{...Object(i["H"])(c),startTimer:d,endTimer:h,setElapsed:l,endScoreChange:u}}const ue=283;var he={name:"Timer",props:["active","config","duration","score"],setup(e,{emit:t}){const{duration:n,score:r}=Object(i["H"])(e),a=le({duration:n,score:r,interval:e.config.timeouts.interval,warn:e.config.thresholds.warn,alert:e.config.thresholds.alert,debug:e.config.debug,emit:t});return{...a,...e.config}},computed:{scoreClass(){return this.scoring?this.scoringStatus===this.SCORING_STATUS.UP?"hit":"miss":""},strokeDasharray(){const e=this.progress/100-1/this.duration*(1-this.progress/100);return`${(e*ue).toFixed(0)} ${ue}`}},methods:{beforeEnter(){this.debug&&console.log("before entered..."),this.setElapsed(0)},afterEnter(){this.debug&&console.log("timer entered..."),this.startTimer()},afterLeave(){this.debug&&console.log("timer left...")}}};n("7a99");he.render=se,he.__scopeId="data-v-275f8882";var me=he,ge={name:"Game",components:{Board:U,Timer:me},setup(){return{config:b}},computed:{...O},methods:{...j,...$}};n("a516");ge.render=G,ge.__scopeId="data-v-8aa15f8c";var fe=ge,pe={name:"Match",components:{Game:fe},computed:{...O,matchId(){return this.$route.params.id}},methods:{...j,...$},async created(){const e=await f(this.matchId);this.load(e.data),this.deal(),setTimeout(()=>{this.shuffle(),this.setCanDnD(!0),this.setPlaying(!0)},1e3)}};n("600a");pe.render=d,pe.__scopeId="data-v-c54af548";var ve=pe;const be=Object(i["M"])("data-v-55a1f694");Object(i["x"])("data-v-55a1f694");const Oe={class:"full-page full-page--match"};Object(i["v"])();const je=be((function(e,t,n,r,a,o){const s=Object(i["C"])("MatchGame");return Object(i["u"])(),Object(i["f"])("div",Oe,[a.showBoard?(Object(i["u"])(),Object(i["f"])(s,{key:0,"color-scheme":a.colorScheme,duration:a.duration,"items-per-board":a.itemsPerBoard,matches:a.matches,config:o.config,onGameOver:o.onGameOver},null,8,["color-scheme","duration","items-per-board","matches","config","onGameOver"])):Object(i["g"])("",!0)])})),ye=Object(i["M"])("data-v-9f56f7fa");Object(i["x"])("data-v-9f56f7fa");const Me={id:"match-game"},we={id:"match-timer"};Object(i["v"])();const Ie=ye((function(e,t,n,r,a,o){const s=Object(i["C"])("MatchTimer"),c=Object(i["C"])("MatchTileBoard"),d=Object(i["C"])("DnD");return Object(i["u"])(),Object(i["f"])(i["b"],{appear:"",css:!0,duration:{enter:""+n.config.game.enterMs,leave:""+n.config.game.leaveMs},"enter-active-class":"fade-in-active","enter-class":"fade-in-start","enter-to-class":"fade-in-end","leave-active-class":"fade-out-active","leave-class":"fade-out-start","leave-to-class":"fade-out-end",onAfterEnter:o.onEntered,onAfterLeave:o.onLeft},{default:ye(()=>[Object(i["i"])("div",Me,[Object(i["i"])("div",we,[Object(i["i"])(s,{"change-ms":n.config.timer.changeMs,duration:n.duration,"enter-ms":n.config.timer.enterMs,"interval-ms":n.config.timer.intervalMs,"leave-ms":n.config.timer.leaveMs,playing:a.playing,score:a.score,onTimerExpired:o.onTimerExpired},null,8,["change-ms","duration","enter-ms","interval-ms","leave-ms","playing","score","onTimerExpired"])]),Object(i["i"])(d,{id:"match-dnd-board",disabled:o.inTransition,playing:a.playing,"throttle-ms":n.config.dnd.throttleMs,onDrag:o.onDrag,onOver:o.onOver,onDrop:o.onDrop},{default:ye(()=>[Object(i["i"])(c,{componentName:"Draggable",id:"terms","tile-type":"term",disabled:o.inTransition,"enter-ms":n.config.tile.enterMs,"leave-ms":n.config.tile.leaveMs,playing:a.playing,tiles:a.terms,"tile-count":n.itemsPerBoard},null,8,["disabled","enter-ms","leave-ms","playing","tiles","tile-count"]),Object(i["i"])(c,{componentName:"Droppable",id:"definitions","tile-type":"definition",disabled:o.inTransition,"enter-ms":n.config.tile.enterMs,"leave-ms":n.config.tile.leaveMs,playing:a.playing,tiles:a.definitions,"tile-count":n.itemsPerBoard},null,8,["disabled","enter-ms","leave-ms","playing","tiles","tile-count"])]),_:1},8,["disabled","playing","throttle-ms","onDrag","onOver","onDrop"])])]),_:1},8,["duration","onAfterEnter","onAfterLeave"])}));function De(e,t){let n=["red","orange","yellow","lime","green","cyan","blue","purple","magenta","navy","gray","teal"];switch(t.toLowerCase()){case"rainbow":return e.map(e=>{let t=Math.floor(Math.random()*n.length),i=n[t];return n.splice(t,1),{...e,color:i}});default:return e.map(e=>({...e,color:""}))}}function Te(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function _e(e,t,n="id"){return Object.prototype.hasOwnProperty.call(t,n)?e.map(e=>e[n]!==t[n]?e:{...e,...t}):e}function xe(e,t,n="id",i){if(!Object.prototype.hasOwnProperty.call(t,n))return e;const r=e.find(e=>e[n]===t[n]),a=i?i(r):t;return r?e.map(e=>e[n]!==a[n]?e:{...e,...a}):e.concat(a)}const Se=Object(i["M"])("data-v-22ef2717"),Pe=Se((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])("div",Object(i["n"])({id:n.id,class:[o.classes]},Object(i["G"])(o.listeners)),[Object(i["B"])(e.$slots,"default")],16,["id"])}));var Be={name:"DnD",props:{disabled:{type:Boolean,required:!1,default:!1},id:{type:String,required:!1},playing:{type:Boolean,required:!0,default:!1},throttleMs:{type:Number,required:!0,default:33.333}},data(){return{dragged:{active:!1}}},computed:{canDrag(){return this.playing&&!this.disabled},classes(){return{board:!0}},dragging(){const{active:e=!1}=this.dragged;return e},listeners(){return this.playing?{mousedown:e=>this.dragStart(e),touchstart:e=>this.dragStart(e),mouseup:e=>this.dragEnd(e),touchend:e=>this.dragEnd(e),mousemove:e=>this.throttledDrag(e),touchmove:e=>this.throttledDrag(e)}:{}},throttledDrag(){return H.a.throttle(this.drag,this.throttleMs,{trailing:!0})}},methods:{dragStart(e){if(e.preventDefault(),!this.canDrag)return;const t=e.target.classList.contains("draggable")?e.target:e.target.closest(".draggable");if(!t)return;const n="touchstart"===e.type?e.touches[0].clientX:e.clientX,i="touchstart"===e.type?e.touches[0].clientY:e.clientY,{top:r,left:a}=t.getBoundingClientRect();this.dragged={active:!0,dragId:t.id,offsetX:n-a,offsetY:i-r,initialX:n,initialY:i}},drag(e){if(e.preventDefault(),!this.canDrag||!this.dragging)return;const{dragId:t,initialX:n,initialY:i,overId:r}=this.dragged,a="touchmove"===e.type?e.touches[0].clientX-n:e.clientX-n,o="touchmove"===e.type?e.touches[0].clientY-i:e.clientY-i;this.$emit("drag",{dragId:t,dragX:a,dragY:o});const{id:s=""}=document.elementsFromPoint("touchmove"===e.type?e.touches[0].clientX:e.clientX,"touchmove"===e.type?e.touches[0].clientY:e.clientY).find(e=>e.classList.contains("droppable"))||{};r!==s&&(this.$emit("over",{dropId:s}),this.dragged={...this.dragged,overId:s})},dragEnd(e){if(e.preventDefault(),this.throttledDrag.cancel(),!this.canDrag||!this.dragging)return;const{dragId:t,initialX:n,initialY:i,offsetX:r,offsetY:a}=this.dragged,o="touchend"===e.type?e.changedTouches[0].clientX:e.clientX,s="touchend"===e.type?e.changedTouches[0].clientY:e.clientY,c=document.elementsFromPoint(o,s).find(e=>e.classList.contains("droppable")),{top:d,left:l}=c&&c.getBoundingClientRect()||{};this.$emit("drop",{dragId:t,dragX:c?o-n:o,dragY:c?s-i:s,dropId:c?c.id:null,dropX:c?Math.round(l-n+r):null,dropY:c?Math.round(d-i+a):null}),this.dragged={active:!1}}},mounted(){console.log(this.$options.name,"mounted...")}};n("5ccd");Be.render=Pe,Be.__scopeId="data-v-22ef2717";var Le=Be;const Ce=Object(i["M"])("data-v-4ef3aa98"),Ee=Ce((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])(i["c"],{appear:"",tag:"div",id:n.id,class:[o.classes],duration:{enter:""+n.enterMs,leave:""+n.leaveMs},css:!0,"enter-class":"fade-in-start","enter-active-class":"fade-in-active","enter-to-class":"fade-in-end","move-class":o.transitionGroup,onAfterEnter:o.onEntered,onLeave:o.onLeft},{default:Ce(()=>[(Object(i["u"])(!0),Object(i["f"])(i["a"],null,Object(i["A"])(o.filteredTiles,e=>(Object(i["u"])(),Object(i["f"])(Object(i["D"])(n.componentName),{key:e.id,content:e.content,disabled:n.disabled,id:e.id,style:[e.style],class:[o.tileClasses,n.tileType,e.className]},null,8,["content","disabled","id","style","class"]))),128))]),_:1},8,["id","class","duration","move-class","onAfterEnter","onLeave"])})),Xe=Object(i["M"])("data-v-0e4639df"),Ye=Xe((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])("div",{id:n.id,innerHTML:n.content},null,8,["id","innerHTML"])}));var $e={name:"Draggable",props:["content","id"]};n("f999");$e.render=Ye,$e.__scopeId="data-v-0e4639df";var Ae=$e;const Ne=Object(i["M"])("data-v-14ad459b"),Ge=Ne((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])("div",{id:n.id,innerHTML:n.content},null,8,["id","innerHTML"])}));var ke={name:"Droppable",props:["content","disabled","id"]};n("3886");ke.render=Ge,ke.__scopeId="data-v-14ad459b";var qe=ke,ze={name:"MatchTileBoard",components:{Draggable:Ae,Droppable:qe},props:["componentName","disabled","duration","enterMs","id","leaveMs","playing","tiles","tileType","tileCount"],computed:{transitionGroup(){return this.disabled?"slide":"no-move-list"},classes(){return{"tile-board":!0,"tile-board--match":!0,"tile-board--disabled":!this.playing,["tiles-"+this.tileCount]:this.tileCount}},filteredTiles(){return this.tiles.filter(e=>e.show)},tileClasses(){return{tile:!0,draggable:"Draggable"===this.componentName,droppable:"Droppable"===this.componentName,disabled:this.disabled}}},methods:{onEntered(){console.log("entered!")},onLeft(e){console.log("left!"),e.style.display="none"}}};n("2089");ze.render=Ee,ze.__scopeId="data-v-4ef3aa98";var Fe=ze;const He=Object(i["M"])("data-v-74f05a30");Object(i["x"])("data-v-74f05a30");const Re={class:"timer__wrapper"},Je={class:"timer__svg",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"},Ue={class:"timer__circle"};Object(i["v"])();const We=He((function(e,t,n,r,a,o){return Object(i["u"])(),Object(i["f"])(i["b"],{duration:{enter:""+n.enterMs,leave:""+n.leaveMs},"enter-active-class":"fade-in-active","enter-class":"fade-in-start","enter-to-class":"fade-in-end","leave-active-class":"fade-out-active","leave-class":"fade-out-start","leave-to-class":"fade-out-end",css:!0,onAfterEnter:o.onEntered,onAfterLeave:o.onLeft},{default:He(()=>[Object(i["L"])(Object(i["i"])("div",{class:"timer",id:n.id},[Object(i["i"])(i["b"],{appear:"",css:!0,duration:{enter:""+n.changeMs,leave:""+n.changeMs},"leave-active-class":"score-out-active","leave-class":"score-out-start","leave-to-class":"score-out-end",onAfterLeave:o.endScoreChange},{default:He(()=>[Object(i["L"])(Object(i["i"])("div",Re,[(Object(i["u"])(),Object(i["f"])("svg",Je,[Object(i["i"])("g",Ue,[Object(i["i"])("circle",{class:["timer__path-elapsed",a.hitMiss],cx:"50",cy:"50",r:"45"},null,2),Object(i["i"])("path",{"stroke-dasharray":o.circleDasharray,class:["timer__path-remaining",[o.severity,a.hitMiss]],d:"M 50, 50\n            m -45, 0\n            a 45,45 0 1,0 90,0\n            a 45,45 0 1,0 -90,0\n          "},null,10,["stroke-dasharray"])])])),Object(i["i"])("span",{class:["timer__label",a.hitMiss]},Object(i["F"])(n.score||o.formattedTimeLeft),3)],512),[[i["J"],!a.scoreChanging]])]),_:1},8,["duration","onAfterLeave"])],8,["id"]),[[i["J"],n.playing]])]),_:1},8,["duration","onAfterEnter","onAfterLeave"])})),Ke=283,Ze=40,Qe=20;var Ve={name:"MatchTimer",props:["active","changeMs","duration","enterMs","id","intervalMs","leaveMs","playing","score"],data(){return{elapsed:0,hitMiss:null,intervalId:null,scoreChanging:!1}},computed:{circleDasharray(){const e=this.progressPct/100-1/this.duration*(1-this.progressPct/100);return(e*Ke).toFixed(0)+" 283"},expired(){return this.remaining<=0},formattedTimeLeft(){const e=Math.floor(this.remaining/6e4);let t=Math.floor(this.remaining%6e4/1e3);return t<10&&(t="0"+t),`${e}:${t}`},progressPct(){return Math.round(this.remaining/(1e3*this.duration)*1e4)/100},remaining(){return 1e3*this.duration-this.elapsed},severity(){return this.progressPct<=Ze?this.progressPct<=Qe?"alert":"warn":"success"}},methods:{onEntered(e){console.log("timer entered..."),this.startTimer()},onLeft(e){console.log("timer left..."),this.elapsed=0},startTimer(){this.elapsed=0,this.intervalId=setInterval(()=>this.elapsed+=this.intervalMs,this.intervalMs)},endTimer(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)},endScoreChange(e){console.log("score changed ending..."),this.scoreChanging=!1,this.hitMiss=null}},watch:{score(e,t){console.log("score changed!"),this.scoreChanging=!0,this.hitMiss=e>t?"hit":"miss"},expired(e,t){!t&&e&&(this.endTimer(),this.$emit("timer-expired"))}},mounted(){console.log(this.$options.name,"mounted...")},unmounted(){this.endTimer()}};n("a9ae");Ve.render=We,Ve.__scopeId="data-v-74f05a30";var et=Ve,tt={name:"MatchGame",components:{DnD:Le,MatchTileBoard:Fe,MatchTimer:et},props:{colorScheme:{type:String,required:!1,default:"rainbow"},config:{type:Object,required:!0},duration:{type:Number,required:!0,default:60},itemsPerBoard:{type:Number,required:!0,default:9},matches:{type:Array,required:!0,default:()=>[]}},data(){return{correct:0,definitions:[],incorrect:0,playing:!1,score:0,stats:[],terms:[],transitioning:!1}},computed:{inTransition:{get(){return this.transitioning},set(e){this.transitioning=e}},progress(){return this.correct/this.itemsPerBoard}},methods:{deal(){console.log("dealing...");const e=Te(this.matches),t=e.slice(0,Math.min(this.itemsPerBoard,e.length));let n=t.map(e=>({...e,matched:!1,show:!0})),i=n.map(e=>{const{term:t,definition:n,...i}=e;return{...i,content:t,answer:n,id:M.a.generate()}});i=De(i,this.colorScheme),this.terms=Te(i);let r=[...n];r=r.map(e=>{const{term:t,definition:n,...i}=e;return{...i,content:n,id:M.a.generate()}}),this.definitions=Te(r)},hitStyle(e,t,n,i,r,a,o){return{"--hit-start-tx":e+"px","--hit-start-ty":t+"px","--hit-start-tz":n+"px","--hit-end-tx":i+"px","--hit-end-ty":r+"px","--hit-end-tz":a+"px","--hit-duration":o+"ms"}},isMatch:function(e,t){const n=e=>t=>t.id===e,{answer:i}=this.terms.find(n(e))||{},{content:r}=this.definitions.find(n(t))||{};return!!i&&!!r&&i===r},missStyle(e,t,n){return{...this.translate(e,t,n)}},moveStyle(e,t,n){return{...this.translate(e,t,n)}},onDrag(e){const{dragId:t,dragX:n,dragY:i}=e||{};this.terms=_e(this.terms,{id:t,style:this.moveStyle(n,i,1),className:"drag"})},onDrop(e){const{dragId:t,dragX:n,dragY:i,dropId:r,dropX:a,dropY:o}=e||{},s=!!r&&this.isMatch(t,r);if(this.terms=_e(this.terms,{id:t,matched:s,className:s?"hit":"miss",style:s?this.hitStyle(n,i,1,a,o,1,this.config.tile.hitMs):this.missStyle(0,0,0)}),!r)return;this.definitions=_e(this.definitions,{id:r,className:s?"hit":"",...s&&{matched:!0}}),this.score=Math.max(s?this.score+1:this.score-1,0);const{content:c}=this.terms.find(e=>e.id===t)||{};this.stats=xe(this.stats,{term:c},"term",e=>e?{term:c,hit:s?e.hit+1:e.hit,miss:s?e.miss:e.miss+1}:{term:c,hit:s?1:0,miss:s?0:1}),s?(this.inTransition=!0,setTimeout(()=>{this.terms=_e(this.terms,{id:t,show:!1}),this.definitions=_e(this.definitions,{id:r,show:!1}),this.correct++,this.inTransition=!1},this.config.tile.hitMs)):this.incorrect++},onEntered(){console.log("game entered..."),this.deal(),this.playing=!0},onLeft(){console.log("game left....")},onOver(e){const{dropId:t}=e||{};this.definitions=this.definitions.map(e=>({...e,className:e.id!==t||e.matched?"":"over"}))},onTimerExpired(){console.log("timer expired..."),this.playing=!1,setTimeout(()=>{this.$emit("game-over",{correct:this.correct,incorrect:this.incorrect,data:this.stats,score:this.score})},2e3)},translate(e,t,n){return{transform:"translate3d("+e+"px, "+t+"px, "+n+"px)"}}},watch:{progress(e,t){t&&Math.floor(e)!==Math.floor(t)?(console.log("new round...",t,"vs",e),this.deal(),this.playing=!0):(console.log("shuffling..."),this.inTransition=!0,this.terms=Te(this.terms),this.definitions=Te(this.definitions),setTimeout(()=>{this.inTransition=!1},this.config.tile.shuffleMs))}}};n("6411");tt.render=Ie,tt.__scopeId="data-v-9f56f7fa";var nt=tt;u.a.defaults.headers.get["Content-Type"]="application/json",u.a.defaults.headers.common["quizdini-timezone"]=Intl.DateTimeFormat().resolvedOptions().timeZone;const it={dnd:{throttleMs:33.33},game:{enterMs:1e3,leaveMs:1e3},tile:{enterMs:800,hitMs:800,leaveMs:0,missMs:800},timer:{intervalMs:100,changeMs:250,enterMs:1e3,leaveMs:1e3}};var rt={name:"Match",components:{MatchGame:nt},data(){return{colorScheme:"",correct:0,definitions:[],duration:60,gameId:null,itemsPerBoard:0,matches:[],showBoard:!1,showSplash:!0,title:""}},computed:{config(){return it},game:{get(){return{colorScheme:this.colorScheme,duration:this.duration,gameId:this.gameId,itemsPerBoard:this.itemsPerBoard,matches:this.matches,title:this.title}},set(e){const{matchId:t,matches:n=[],options:{duration:i=60,colorScheme:r="",itemsPerBoard:a=9}={},title:o=""}=e;this.colorScheme=r,this.duration=i,this.gameId=t,this.itemsPerBoard=a,this.matches=n,this.title=o}},matchId(){return this.$route.params.id}},methods:{async fetchMatch(){try{const e=await u.a.get("/api/match/"+this.matchId,{timeout:1e4});return e.data}catch(e){console.log(e)}},async postPing(e){try{const t=await u.a.post("/api/ping",e,{timeout:1e4});return t.data}catch(t){console.log(t)}},async onGameOver(e){console.log("on game over..."),this.showBoard=!1;const t=await this.postPing({gameId:this.matchId,gameType:"M",results:e});console.log(JSON.stringify(t)),setTimeout(()=>{this.showBoard=!0},5e3)}},async created(){const e=await this.fetchMatch();this.game=e,this.showBoard=!0},mounted(){console.log(this.$options.name,"mounted...")}};n("5e4a");rt.render=je,rt.__scopeId="data-v-55a1f694";var at=rt;const ot=Object(i["M"])("data-v-b788fbbe");Object(i["x"])("data-v-b788fbbe");const st={class:"p-4"};Object(i["v"])();const ct=ot((function(e,t,n,r,a,o){const s=Object(i["C"])("router-link");return Object(i["u"])(),Object(i["f"])("div",st,[Object(i["i"])("ul",null,[(Object(i["u"])(!0),Object(i["f"])(i["a"],null,Object(i["A"])(a.games,e=>(Object(i["u"])(),Object(i["f"])("li",{key:e.id},[Object(i["i"])(s,{class:"game-link game-link--match",to:{name:"match",params:{id:e.id}}},{default:ot(()=>[Object(i["h"])(Object(i["F"])(e.title),1)]),_:2},1032,["to"])]))),128))])])}));u.a.defaults.headers.get["Content-Type"]="application/json",u.a.defaults.headers.common["quizdini-timezone"]=Intl.DateTimeFormat().resolvedOptions().timeZone;var dt={name:"Matches",data(){return{games:[]}},methods:{async fetchData(){try{const e=await u.a.get("/api/matches/",{timeout:3e4});return e.data}catch(e){console.log(e)}}},async created(){const e=await this.fetchData(),t=e.map(e=>({id:e.matchId,title:e.title}));this.games=t}};n("1c66");dt.render=ct,dt.__scopeId="data-v-b788fbbe";var lt=dt;const ut=[{path:"/",name:"matches",component:lt,props:!1},{path:"/match/:id",name:"match",component:at,props:!1},{path:"/newmatch/:id",name:"newmatch",component:ve,props:!1}],ht=Object(s["a"])({history:Object(s["b"])(),routes:ut});var mt=ht;Object(i["e"])(o).use(mt).mount("#quizdini")},"58e1":function(e,t,n){},"5ccd":function(e,t,n){"use strict";n("bb1b")},"5e4a":function(e,t,n){"use strict";n("58e1")},"5e91":function(e,t,n){},"5fb1":function(e,t,n){},"600a":function(e,t,n){"use strict";n("5e91")},6411:function(e,t,n){"use strict";n("015f")},"64b6":function(e,t,n){"use strict";n("5fb1")},"660f":function(e,t,n){},"6ae5":function(e,t,n){},"70f3":function(e,t,n){},"7a99":function(e,t,n){"use strict";n("10a7")},"91f5":function(e,t,n){"use strict";n("6ae5")},"93e9":function(e,t,n){"use strict";n("e83c")},"9cdc":function(e,t,n){"use strict";n("c701")},a516:function(e,t,n){"use strict";n("660f")},a9ae:function(e,t,n){"use strict";n("e57b")},bb1b:function(e,t,n){},c701:function(e,t,n){},e57b:function(e,t,n){},e83c:function(e,t,n){},f999:function(e,t,n){"use strict";n("17c0")}});
//# sourceMappingURL=app.4bf2fdf1.js.map